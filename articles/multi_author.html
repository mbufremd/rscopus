<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Gathering Multiple Subject Queries with Large Numbers of Authors • rscopus</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Gathering Multiple Subject Queries with Large Numbers of Authors">
<meta property="og:description" content="rscopus">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rscopus</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.7.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/api_key.html">Setting up the Scopus API Key</a>
    </li>
    <li>
      <a href="../articles/multi_author.html">Gathering Multiple Subject Queries with Large Numbers of Authors</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/muschellij2/rscopus/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="multi_author_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Gathering Multiple Subject Queries with Large Numbers of Authors</h1>
                        <h4 data-toc-skip class="author">John Muschelli and Clarke Iakovakis</h4>
            
            <h4 data-toc-skip class="date">2021-12-18</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/muschellij2/rscopus/blob/HEAD/vignettes/multi_author.Rmd" class="external-link"><code>vignettes/multi_author.Rmd</code></a></small>
      <div class="hidden name"><code>multi_author.Rmd</code></div>

    </div>

    
    
<p>In <code>rscopus</code> we try to use the Scopus API to present queries about authors and affiliations. Here we will use an example from Clarke Iakovakis.</p>
<div class="section level2">
<h2 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h2>
<p>First, let’s load in the packages we’ll need.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://dev.elsevier.com/sc_apis.html" class="external-link">"rscopus"</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://dplyr.tidyverse.org" class="external-link">"dplyr"</a></span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'dplyr'</span>
<span class="co">#&gt; The following objects are masked from 'package:stats':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     filter, lag</span>
<span class="co">#&gt; The following objects are masked from 'package:base':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     intersect, setdiff, setequal, union</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://tidyr.tidyverse.org" class="external-link">"tidyr"</a></span><span class="op">)</span></code></pre></div>
<p>Next, we need to see if we have an API key available. See the API key vignette for more information and how to set the keys up. We will use the <code><a href="../reference/get_api_key.html">have_api_key()</a></code> functionality.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/get_api_key.html">have_api_key</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; [1] FALSE</span></code></pre></div>
<p>We also need to make sure you are authorized to search Scopus with <code>is_elsevier_authorized</code>. If you have an API key, but <code><a href="../reference/elsevier_authenticate.html">is_elsevier_authorized()</a></code> is <code>FALSE</code>, then it’s likely due to the fact that you’re not on the necessary IP that the key needs:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">authorized</span> <span class="op">=</span> <span class="fu"><a href="../reference/elsevier_authenticate.html">is_elsevier_authorized</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="creating-a-query">Creating a query<a class="anchor" aria-label="anchor" href="#creating-a-query"></a>
</h2>
<p>Here we will create a query of a specific affiliation, subject area, publication year, and type of access (OA = open access). Let’s look at the different types of subject areas:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">rscopus</span><span class="fu">::</span><span class="fu"><a href="../reference/subject_areas.html">subject_areas</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt;  [1] "AGRI" "ARTS" "BIOC" "BUSI" "CENG" "CHEM" "COMP" "DECI" "DENT" "EART"</span>
<span class="co">#&gt; [11] "ECON" "ENER" "ENGI" "ENVI" "HEAL" "IMMU" "MATE" "MATH" "MEDI" "NEUR"</span>
<span class="co">#&gt; [21] "NURS" "PHAR" "PHYS" "PSYC" "SOCI" "VETE" "MULT"</span></code></pre></div>
<p>These categories are helpful because to search all the documents it’d be too big of a call. We may also get rate limited. We can search each separately, store the information, save them, merge them, and then run our results.</p>
<p>The author of this example was analyzing data from OSU (Oklahoma State University), and uses the affiliation ID from that institution (<code>60006514</code>). If you know the institution name, but not the ID, you can use <code>process_affiliation_name</code> to retrieve it. Here we make the queries for each subject area:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># create the query</span>
<span class="va">Query</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"AF-ID(60006514) AND SUBJAREA("</span>, 
                <span class="fu"><a href="../reference/subject_areas.html">subject_areas</a></span><span class="op">(</span><span class="op">)</span>, 
                <span class="st">") AND PUBYEAR = 2018 AND ACCESSTYPE(OA)"</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="running-the-query">Running the query<a class="anchor" aria-label="anchor" href="#running-the-query"></a>
</h2>
<p>Let’s pull the first subject area information. Note, the count may depend on your API key limits. We also are asking for a complete view, rather than the standard view. The <code>max_count</code> is set to <span class="math inline">\(20000\)</span>, so this may not be enough for your query and you need to adjust.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw">if</span> <span class="op">(</span><span class="va">authorized</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">make_query</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">subj_area</span><span class="op">)</span> <span class="op">{</span>
    <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"AF-ID(60006514) AND SUBJAREA("</span>, 
           <span class="va">subj_area</span>,
           <span class="st">") AND PUBYEAR = 2018 AND ACCESSTYPE(OA)"</span><span class="op">)</span>
  <span class="op">}</span>
  <span class="va">i</span> <span class="op">=</span> <span class="fl">3</span>
  <span class="va">subj_area</span> <span class="op">=</span> <span class="fu"><a href="../reference/subject_areas.html">subject_areas</a></span><span class="op">(</span><span class="op">)</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>
  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">subj_area</span><span class="op">)</span>
  <span class="va">completeArticle</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/scopus_search.html">scopus_search</a></span><span class="op">(</span>
    query <span class="op">=</span> <span class="fu">make_query</span><span class="op">(</span><span class="va">subj_area</span><span class="op">)</span>, 
    view <span class="op">=</span> <span class="st">"COMPLETE"</span>, 
    count <span class="op">=</span> <span class="fl">200</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">completeArticle</span><span class="op">)</span><span class="op">)</span>
  <span class="va">total_results</span> <span class="op">=</span> <span class="va">completeArticle</span><span class="op">$</span><span class="va">total_results</span>
  <span class="va">total_results</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">total_results</span><span class="op">)</span>
<span class="op">}</span> <span class="kw">else</span> <span class="op">{</span>
  <span class="va">total_results</span> <span class="op">=</span> <span class="fl">0</span>
<span class="op">}</span></code></pre></div>
<p>Here we see the total results of the query. This can be useful if the <code>total_results = 0</code> or they are greater than the max count specified (not all records in Scopus are returned).</p>
</div>
<div class="section level2">
<h2 id="getting-the-content">Getting the content<a class="anchor" aria-label="anchor" href="#getting-the-content"></a>
</h2>
<p>The <code>gen_entries_to_df</code> function is an attempt at turning the parsed JSON to something more manageable from the API output. You may want to go over the list elements <code>get_statements</code> in the output of <code>completeArticle</code>. The original content can be extracted using <code><a href="https://httr.r-lib.org/reference/content.html" class="external-link">httr::content()</a></code> and the <code>"type"</code> can be specified, such as <code>"text"</code> and then <code><a href="https://rdrr.io/pkg/jsonlite/man/fromJSON.html" class="external-link">jsonlite::toJSON</a></code> can be used explicitly on the JSON output. Alternatively, any arguments to <code><a href="https://rdrr.io/pkg/jsonlite/man/fromJSON.html" class="external-link">jsonlite::toJSON</a></code> can be passed directly into <code><a href="https://httr.r-lib.org/reference/content.html" class="external-link">httr::content()</a></code>, such as <code>flatten</code> or <code>simplifyDataFrame</code>.</p>
<p>These are all alternative options, but we will use <code>rscopous::gen_entries_to_df</code>. The output is a list of <code>data.frame</code>s after we pass in the <code>entries</code> elements from the list.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw">if</span> <span class="op">(</span><span class="va">authorized</span><span class="op">)</span> <span class="op">{</span>
  
  <span class="co"># areas = subject_areas()[12:13]  </span>
  <span class="va">areas</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ENER"</span>, <span class="st">"ENGI"</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">areas</span><span class="op">)</span> <span class="op">=</span> <span class="va">areas</span>
  <span class="va">results</span> <span class="op">=</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span>
    <span class="va">areas</span>,
    <span class="kw">function</span><span class="op">(</span><span class="va">subj_area</span><span class="op">)</span> <span class="op">{</span>
      <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">subj_area</span><span class="op">)</span>
      <span class="va">completeArticle</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/scopus_search.html">scopus_search</a></span><span class="op">(</span>
        query <span class="op">=</span> <span class="fu">make_query</span><span class="op">(</span><span class="va">subj_area</span><span class="op">)</span>, 
        view <span class="op">=</span> <span class="st">"COMPLETE"</span>, 
        count <span class="op">=</span> <span class="fl">200</span>,
        verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
      <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">completeArticle</span><span class="op">)</span>
    <span class="op">}</span><span class="op">)</span>
  <span class="va">entries</span> <span class="op">=</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">results</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">x</span><span class="op">$</span><span class="va">entries</span>
  <span class="op">}</span><span class="op">)</span>
  <span class="va">total_results</span> <span class="op">=</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map_dbl</a></span><span class="op">(</span><span class="va">results</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span>
    <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">total_results</span><span class="op">)</span>
  <span class="op">}</span><span class="op">)</span>  
  <span class="va">total_results</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">total_results</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
  
  <span class="va">df</span> <span class="op">=</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">entries</span>, <span class="va">gen_entries_to_df</span><span class="op">)</span>
  <span class="va">MainEntry</span> <span class="op">=</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map_df</a></span><span class="op">(</span><span class="va">df</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">x</span><span class="op">$</span><span class="va">df</span>
  <span class="op">}</span>, .id <span class="op">=</span> <span class="st">"subj_area"</span><span class="op">)</span>
  
  <span class="va">ddf</span> <span class="op">=</span> <span class="va">MainEntry</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
               <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">`author-count.$`</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">99</span><span class="op">)</span>
  <span class="kw">if</span> <span class="op">(</span><span class="st">"message"</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">ddf</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">ddf</span> <span class="op">=</span>  <span class="va">ddf</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
               <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">message</span>, <span class="va">`author-count.$`</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ddf</span><span class="op">)</span><span class="op">)</span>
  <span class="op">}</span>
  
  <span class="va">MainEntry</span> <span class="op">=</span> <span class="va">MainEntry</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>
      scopus_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"SCOPUS_ID:"</span>, <span class="st">""</span>, <span class="va">`dc:identifier`</span><span class="op">)</span>,
      entry_number <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">entry_number</span><span class="op">)</span>,
      doi <span class="op">=</span> <span class="va">`prism:doi`</span><span class="op">)</span>    
  <span class="co">#################################</span>
  <span class="co"># remove duplicated entries</span>
  <span class="co">#################################</span>
  <span class="va">MainEntry</span> <span class="op">=</span> <span class="va">MainEntry</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/duplicated.html" class="external-link">duplicated</a></span><span class="op">(</span><span class="va">scopus_id</span><span class="op">)</span><span class="op">)</span>  
  
  <span class="va">Authors</span> <span class="op">=</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map_df</a></span><span class="op">(</span><span class="va">df</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">x</span><span class="op">$</span><span class="va">author</span>
  <span class="op">}</span>, .id <span class="op">=</span> <span class="st">"subj_area"</span><span class="op">)</span>  
  <span class="va">Authors</span><span class="op">$</span><span class="va">`afid.@_fa`</span> <span class="op">=</span> <span class="cn">NULL</span>
  
  <span class="va">Affiliation</span> <span class="op">=</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map_df</a></span><span class="op">(</span><span class="va">df</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">x</span><span class="op">$</span><span class="va">affiliation</span>
  <span class="op">}</span>, .id <span class="op">=</span> <span class="st">"subj_area"</span><span class="op">)</span>    
  <span class="va">Affiliation</span><span class="op">$</span><span class="va">`@_fa`</span> <span class="op">=</span> <span class="cn">NULL</span>
  
  <span class="co"># keep only these non-duplicated records</span>
  <span class="va">MainEntry_id</span> <span class="op">=</span> <span class="va">MainEntry</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">entry_number</span>, <span class="va">subj_area</span><span class="op">)</span>
  <span class="va">Authors</span> <span class="op">=</span> <span class="va">Authors</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>entry_number <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">entry_number</span><span class="op">)</span><span class="op">)</span>
  
  <span class="va">Affiliation</span> <span class="op">=</span> <span class="va">Affiliation</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>entry_number <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">entry_number</span><span class="op">)</span><span class="op">)</span>    
  
  <span class="va">Authors</span> <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">MainEntry_id</span>, <span class="va">Authors</span><span class="op">)</span>
  <span class="va">Affiliation</span> <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">MainEntry_id</span>, <span class="va">Affiliation</span><span class="op">)</span>
  
  
  <span class="co"># first filter to get only OSU authors</span>
  <span class="va">osuauth</span> <span class="op">&lt;-</span> <span class="va">Authors</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">`afid.$`</span> <span class="op">==</span> <span class="st">"60006514"</span><span class="op">)</span>
  
<span class="op">}</span></code></pre></div>
<p>At the end of the day, we have the author-level information for each paper. The <code>entry_number</code> will join these <code>data.frame</code>s if necessary. The <code>df</code> element has the paper-level information in this example, the <code>author</code> <code>data.frame</code> has author information, including affiliations. There can be multiple affiliations, even within institution, such as multiple department affiliations within an institution affiliation. The <code>affiliation</code> information relates to the affiliations and can be merged with the author information.</p>
</div>
<div class="section level2">
<h2 id="funding-agencies">Funding agencies<a class="anchor" aria-label="anchor" href="#funding-agencies"></a>
</h2>
<p>Here we look at the funding agencies listed on all the papers. This can show us if there is a pattern in the funding sponsor and the open-access publications. Overall, though, we would like to see the funding of all the papers if a specific funder requires open access. This checking allows libraries and researchers ensure they are following the guidelines of the funding agency.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw">if</span> <span class="op">(</span><span class="va">total_results</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">cn</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">MainEntry</span><span class="op">)</span>
  <span class="va">cn</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"fund"</span>, <span class="fu"><a href="https://rdrr.io/r/base/chartr.html" class="external-link">tolower</a></span><span class="op">(</span><span class="va">cn</span><span class="op">)</span><span class="op">)</span><span class="op">]</span>
  
  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">MainEntry</span><span class="op">$</span><span class="va">`fund-sponsor`</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
  
  <span class="va">funderPoland</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span>
    <span class="va">MainEntry</span>, 
    <span class="va">`fund-sponsor`</span> <span class="op">==</span> <span class="st">"Ministerstwo Nauki i Szkolnictwa Wyższego"</span> <span class="op">)</span>  
  <span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">funderPoland</span><span class="op">)</span>
  
  <span class="va">osuFunders</span> <span class="op">&lt;-</span> <span class="va">MainEntry</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">`fund-sponsor`</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">tally</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html" class="external-link">desc</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span>
  <span class="va">osuFunders</span>
<span class="op">}</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="number-of-author-limits">Number of author limits<a class="anchor" aria-label="anchor" href="#number-of-author-limits"></a>
</h2>
<p>In the Scopus API, if there are <span class="math inline">\(&gt; 100\)</span> authors on a paper, it only will retrieve the first 100 authors. For those cases, we must use the <code>abstract_retrieval</code> to get all the author-level information. Here we make this information into an integer so that we can filter the rows we need to run based on author count.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw">if</span> <span class="op">(</span><span class="va">total_results</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span>

  <span class="co"># if there are 100+ authors, you have to use the abstract_retrieval function to get the full author data</span>
  <span class="co"># coerce to integer first</span>
  <span class="va">MainEntry</span> <span class="op">&lt;-</span> <span class="va">MainEntry</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>`author-count.$` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">`author-count.$`</span><span class="op">)</span><span class="op">)</span>
  <span class="va">run_multi</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="va">MainEntry</span><span class="op">$</span><span class="va">`author-count.$`</span> <span class="op">&gt;</span> <span class="fl">99</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">run_multi</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>In this case, we see there are some articles with author counts <span class="math inline">\(&gt; 99\)</span> and we must get all author information for those.</p>
</div>
<div class="section level2">
<h2 id="more-than-100-authors">More than 100 authors<a class="anchor" aria-label="anchor" href="#more-than-100-authors"></a>
</h2>
<p>Now, the <code>abstract_retrieval</code> function can take a number of identifiers for papers, such as DOI, PubMed ID, and Scopus ID. Here we will use the Scopus ID, as it is given for all results, but we could also use DOI.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw">if</span> <span class="op">(</span><span class="va">total_results</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span>
  <span class="kw">if</span> <span class="op">(</span><span class="va">run_multi</span><span class="op">)</span> <span class="op">{</span>
    
    <span class="va">MainEntry_99auth</span> <span class="op">&lt;-</span> <span class="va">MainEntry</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">`author-count.$`</span> <span class="op">&gt;</span> <span class="fl">99</span><span class="op">)</span>
    
    <span class="va">MainEntry_99auth_id</span> <span class="op">=</span> <span class="va">MainEntry_99auth</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">entry_number</span>, <span class="va">subj_area</span><span class="op">)</span>
    <span class="va">auth99</span> <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">MainEntry_99auth_id</span>, <span class="va">Authors</span><span class="op">)</span>
    <span class="va">affil99</span> <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">MainEntry_99auth_id</span>, <span class="va">Affiliation</span><span class="op">)</span>

    
    <span class="va">missing_table</span> <span class="op">=</span> <span class="va">MainEntry</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate_all.html" class="external-link">mutate_at</a></span><span class="op">(</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">scopus_id</span>, <span class="va">doi</span><span class="op">)</span>, .funs <span class="op">=</span> <span class="va">is.na</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise_all.html" class="external-link">summarize_at</a></span><span class="op">(</span>.vars <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">scopus_id</span>, <span class="va">doi</span><span class="op">)</span>, .funs <span class="op">=</span> <span class="va">sum</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">missing_table</span><span class="op">)</span>
  <span class="op">}</span>
<span class="op">}</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="get-all-the-authors">Get all the authors<a class="anchor" aria-label="anchor" href="#get-all-the-authors"></a>
</h2>
<p>Here we will go through each Scopus ID and get the article information. We will create an affiliation <code>data.frame</code> and an author <code>data.frame</code>. The non-relevant columns will be deleted, such as <code>entry_number</code> since it refers to a different set of elements from a list now. The column names will be harmonized with the <code>Authors</code> and <code>Affiliation</code> data sets. The respective data is removed from the <code>Authors</code> and <code>Affiliation</code> data set and joined with the new data with the richer information.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw">if</span> <span class="op">(</span><span class="va">total_results</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span>
  <span class="co"># ids = MainEntry_99auth$scopus_id[1:3]</span>
  <span class="va">ids</span> <span class="op">=</span> <span class="va">MainEntry_99auth</span><span class="op">$</span><span class="va">scopus_id</span>
  <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">ids</span><span class="op">)</span> <span class="op">=</span> <span class="va">ids</span>
  <span class="va">big_list</span> <span class="op">=</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span>
    <span class="va">ids</span>, 
    <span class="va">abstract_retrieval</span>, 
    identifier <span class="op">=</span> <span class="st">"scopus_id"</span>,
    verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
  
  <span class="va">all_affil_df</span> <span class="op">=</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map_df</a></span><span class="op">(</span>
    <span class="va">big_list</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span>
      <span class="va">d</span> <span class="op">=</span> <span class="fu"><a href="../reference/gen_entries_to_df.html">gen_entries_to_df</a></span><span class="op">(</span>
        <span class="va">x</span><span class="op">$</span><span class="va">content</span><span class="op">$</span><span class="va">`abstracts-retrieval-response`</span><span class="op">$</span><span class="va">affiliation</span><span class="op">)</span>
      <span class="va">d</span><span class="op">$</span><span class="va">df</span>
    <span class="op">}</span>, .id <span class="op">=</span> <span class="st">"scopus_id"</span><span class="op">)</span>  
  
  <span class="va">all_df</span> <span class="op">=</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map_df</a></span><span class="op">(</span>
    <span class="va">big_list</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span>
      <span class="va">d</span> <span class="op">=</span> <span class="fu"><a href="../reference/gen_entries_to_df.html">gen_entries_to_df</a></span><span class="op">(</span>
        <span class="va">x</span><span class="op">$</span><span class="va">content</span><span class="op">$</span><span class="va">`abstracts-retrieval-response`</span><span class="op">$</span><span class="va">authors</span><span class="op">$</span><span class="va">author</span><span class="op">)</span>
      <span class="va">d</span><span class="op">$</span><span class="va">df</span>
    <span class="op">}</span>, .id <span class="op">=</span> <span class="st">"scopus_id"</span><span class="op">)</span>
  
  <span class="co">##########################</span>
  <span class="co"># Remove prefix ce: for harmonization</span>
  <span class="co">##########################</span>
  <span class="va">no_ce</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span>
    <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"^ce:"</span>, <span class="st">""</span>, <span class="va">x</span><span class="op">)</span>
  <span class="op">}</span>
  <span class="va">all_df</span> <span class="op">=</span> <span class="va">all_df</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select_all.html" class="external-link">rename_all</a></span><span class="op">(</span>.funs <span class="op">=</span> <span class="va">no_ce</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>authid <span class="op">=</span> <span class="st">"@auid"</span>,
           `afid.$` <span class="op">=</span> <span class="va">`affiliation.@id`</span>,
           authname <span class="op">=</span> <span class="st">"indexed-name"</span><span class="op">)</span>
  
  <span class="va">all_df</span><span class="op">$</span><span class="va">entry_number</span> <span class="op">=</span> <span class="cn">NULL</span>
  <span class="va">all_affil_df</span><span class="op">$</span><span class="va">entry_number</span> <span class="op">=</span> <span class="cn">NULL</span>
  
  <span class="va">author_table</span> <span class="op">=</span> <span class="va">all_df</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">scopus_id</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span><span class="va">authid</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">tally</a></span><span class="op">(</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">author_table</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html" class="external-link">stopifnot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="va">ids</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">author_table</span><span class="op">$</span><span class="va">scopus_id</span><span class="op">)</span><span class="op">)</span>
  <span class="co"># harmonizing with MainEntry</span>
  <span class="va">author_table</span> <span class="op">=</span> <span class="va">author_table</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>`author-count.$` <span class="op">=</span> <span class="va">n</span><span class="op">)</span>
  <span class="va">MainEntry_99auth</span><span class="op">$</span><span class="va">`author-count.$`</span> <span class="op">=</span> <span class="cn">NULL</span>
  <span class="va">MainEntry_99auth</span> <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">MainEntry_99auth</span>, <span class="va">author_table</span><span class="op">)</span>
  
  
  <span class="co">#######################</span>
  <span class="co"># Harmonized</span>
  <span class="co">#######################</span>
  <span class="va">all_df</span> <span class="op">=</span> <span class="va">MainEntry_99auth</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">entry_number</span>, <span class="va">subj_area</span>, <span class="va">scopus_id</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">all_df</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://generics.r-lib.org/reference/setops.html" class="external-link">setdiff</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">Authors</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">all_df</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
  
  <span class="co"># grab only relevant columns</span>
  <span class="va">all_df</span> <span class="op">=</span> <span class="va">all_df</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">Authors</span><span class="op">)</span><span class="op">]</span>
  
  <span class="co"># remove the old entries</span>
  <span class="va">Authors</span> <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter-joins.html" class="external-link">anti_join</a></span><span class="op">(</span><span class="va">Authors</span>, <span class="va">MainEntry_99auth_id</span><span class="op">)</span>
  <span class="co"># put the new data in</span>
  <span class="va">Authors</span> <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">full_join</a></span><span class="op">(</span><span class="va">Authors</span>, <span class="va">all_df</span><span class="op">)</span>
  
  <span class="co">#######################</span>
  <span class="co"># Harmonized</span>
  <span class="co">#######################  </span>
  <span class="va">all_affil_df</span> <span class="op">=</span> <span class="va">all_affil_df</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>`affiliation-url` <span class="op">=</span> <span class="st">"@href"</span>,
           afid <span class="op">=</span> <span class="st">"@id"</span><span class="op">)</span>
  <span class="va">all_affil_df</span> <span class="op">=</span> <span class="va">MainEntry_99auth</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">entry_number</span>, <span class="va">subj_area</span>, <span class="va">scopus_id</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">all_affil_df</span><span class="op">)</span>  
  <span class="fu"><a href="https://generics.r-lib.org/reference/setops.html" class="external-link">setdiff</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">Affiliation</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">all_affil_df</span><span class="op">)</span><span class="op">)</span>  
  
  <span class="co"># remove the old entries</span>
  <span class="va">Affiliation</span> <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter-joins.html" class="external-link">anti_join</a></span><span class="op">(</span><span class="va">Affiliation</span>, <span class="va">MainEntry_99auth_id</span><span class="op">)</span>
  <span class="co"># put the new data in</span>
  <span class="va">Affiliation</span> <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">full_join</a></span><span class="op">(</span><span class="va">Affiliation</span>, <span class="va">all_affil_df</span><span class="op">)</span>
  
  <span class="va">MainEntry</span> <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter-joins.html" class="external-link">anti_join</a></span><span class="op">(</span><span class="va">MainEntry</span>, <span class="va">MainEntry_99auth_id</span><span class="op">)</span>
  <span class="va">MainEntry</span> <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">full_join</a></span><span class="op">(</span><span class="va">MainEntry</span>, <span class="va">MainEntry_99auth</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
</div>
<div class="section level1">
<h1 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h1>
<p>The Scopus API has limits for different searches and calls. Using a combination of APIs, we can gather all the information on authors that we would like. This gives us a full picture of the authors and co-authorship at a specific institution in specific scenarios, such as the open access publications from 2018.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by John Muschelli.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
